<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Loading Assets, the J&#246;tunn way </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Loading Assets, the J&#246;tunn way ">
    <meta name="generator" content="docfx 2.56.7.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="loading-assets-the-jötunn-way">Loading Assets, the Jötunn way</h1>

<p>Inside of our <code>Awake</code> in our <code>BaseUnityPlugin</code> we will invoke a new method <code>loadAssets();</code> which will load the prefabs from our asset bundles and resources into our plugin. To facilitate this we will first need to define some fields as such:</p>
<pre><code class="lang-cs">public AssetBundle TestAssets;
public AssetBundle BlueprintRuneBundle;
public Skills.SkillType TestSkillType = 0;
private Texture2D testTex;
private Sprite testSprite;
private GameObject backpackPrefab;
private AssetBundle embeddedResourceBundle;
</code></pre><p>To acquire the references we will be using here you may <a href="https://github.com/Valheim-Modding/JotunnModExample/blob/master/JotunnModExample/assets.zip">download</a> them and place inside your project root: </p>
<p><img src="../../Documentation/images/data/AssetsExtraction.png" alt="Assets Extraction"></p>
<p>Next, we must import our assets into our project, and ensure they are packed into, or with our plugin. There are a number of ways to do this, such as:</p>
<h3 id="side-loading">Side loading</h3>
<p>Side loading would be where the assets are packaged alongside your plugin.dll. </p>
<p>You may have noticed that we include a postbuild command to copy the <code>Assets</code> directory into the games plugin directory. Although this allows for easy development iteration though being able to change assets without recompilation, it is not so easily distributable to users, and must be packaged side by side with your released plugin, and exposes your assets to being directly modified by the user.</p>
<p><code>&lt;Exec Command=&quot;xcopy &amp;quot;$(ProjectDir)Assets&amp;quot; &amp;quot;$(VALHEIM_INSTALL)\BepInEx\plugins\JotunnModExample\Assets\&amp;quot; /S /Y&quot; /&gt;</code></p>
<h3 id="embedded-resource">Embedded resource</h3>
<p>Right click our solution, then add a new directory named <code>AssetsEmbedded</code>. Right click the directory and select <code>Add existing</code> and select the files we placed inside from the download link provided.</p>
<p>Another option is to embed our resources inside the binary itself. You may do this by right clicking a folder inside of your project, and add an existing item. Once it has been added, right click the item, select properties, and set the build action to embedded resource: 
<img src="../../Documentation/images/data/Assets.EmbeddedResource.png" alt="Assets.Embedded Resource"></p>
<h3 id="referencing-our-assets">Referencing our assets</h3>
<p>In order to load our resources, we can utilise Jötunn&#39;s <a class="xref" href="../../api/Jotunn.Utils.AssetUtils.html">AssetUtils</a> helper methods, such as <a class="xref" href="../../api/Jotunn.Utils.AssetUtils.html#Jotunn_Utils_AssetUtils_LoadTexture_System_String_System_Boolean_">LoadTexture</a>, <a class="xref" href="../../api/Jotunn.Utils.AssetUtils.html#Jotunn_Utils_AssetUtils_LoadAssetBundle_System_String_">LoadAssetBundle</a>, <a href="xref:Jotunn.Utils.AssetUtils.LoadAssetBundleFromResources(System.String,System.Reflection.Assembly)">LoadAssetBundleFromResources</a>. The method bellow showcases a number of ways to load your assets into various forms of objects.</p>
<pre><code class="lang-cs">private void LoadAssets()
{
    // Load texture
    testTex = AssetUtils.LoadTexture(&quot;JotunnModExample/Assets/test_tex.jpg&quot;);
    testSprite = Sprite.Create(testTex, new Rect(0f, 0f, testTex.width, testTex.height), Vector2.zero);

    // Load asset bundle from filesystem
    TestAssets = AssetUtils.LoadAssetBundle(&quot;JotunnModExample/Assets/jotunnlibtest&quot;);
    Jotunn.Logger.LogInfo(TestAssets);

    // Load asset bundle from filesystem
    BlueprintRuneBundle = AssetUtils.LoadAssetBundle(&quot;JotunnModExample/Assets/blueprints&quot;);
    Jotunn.Logger.LogInfo(BlueprintRuneBundle);

    //Load embedded resources
    embeddedResourceBundle = AssetUtils.LoadAssetBundleFromResources(&quot;capeironbackpack&quot;);
    backpackPrefab = embeddedResourceBundle.LoadAsset&lt;GameObject&gt;(&quot;Assets/Evie/CapeIronBackpack.prefab&quot;);

    // Embedded Resources
    Jotunn.Logger.LogInfo($&quot;Embedded resources: {string.Join(&quot;,&quot;, Assembly.GetExecutingAssembly().GetManifestResourceNames())}&quot;);
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Valheim-Modding/Jotunn/blob/51c9fcf56710516661c2146effdf62ea682045c9/JotunnLib/Documentation/tutorials/data/assets.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
